# Exercise 4.2


1. Distribute load generation Deployment
```
kubectl create deployment hog --image vish/stress
kubectl get deployment
```

##

2. Check details and check in yaml format
```
kubectl describe deployment hog
kubectl get deployment hog -o yaml
```

##

Save as 3.yaml file
```
kubectl get deployment hog -o yaml > hog.yaml
```

##

4. Open the file to modify
```
we hog.yaml
```
Modify spec.template.spec.containers[0].resources as below
```
        resources:
          limits:
            memory: "4Gi"
          requests:
            memory: "2500Mi"
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
```

##

5. Redistribution as an edited file
```
kubectl replace -f hog.yaml
```

##

6. Check again in yaml form
```
kubectl get deployment hog -o yaml
```

##

7. Check the log of pod
```
kubectl get pods
```
```
kubectl logs <pod name from above>
```

8. Open two more terminals, access CP and worker, and run the top command
```
top
```
Check CPU usage

##

Change the CPU memory stress factor by modifying the 9.hog.yaml file
```
we hog.yaml
```
Modify spec.template.spec.containers[0].args as below
```
resources:
  limits:
    cpu: "1"
    memory: "4Gi"
  requests:
    cpu: "0.5"
    memory: "500Mi"
args:
- -cpus
- "2"
- -mem-total
- "950Mi"
- -mem-alloc-size
- "100Mi"
- -mem-alloc-sleep
- "1s"
```  

##

Redeployment after deleting 10.Deployment
```
kubectl delete deployment hog
```
```
kubectl create -f hog.yaml
```

Check the usage on the node where the top command was executed again